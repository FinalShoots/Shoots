<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.Shoots.service.report.ReportMapper">

    <insert id="insertReport">
        insert into report(reporterUser, reportedUser, category, PostIdx, CommentIdx)
        values( #{reporterUser}, #{reportedUser}, #{category}, COALESCE(#{PostIdx}, 0), COALESCE(#{CommentIdx}, 0) );
    </insert>

    <select id="selectReportedUsers" resultType="Report">
        select * from report
        where reporterUser=#{reporter};
    </select>

    <select id="selectCheckReportDuplicate" resultType="Report">
        select *
        from report
        where reporterUser=#{reporter} and reportedUser=#{reported} and category=#{category}
        LIMIT 1
    </select>

    <select id="selectReportedCount" resultType="int">
        select count(*)
        from report
        where reportedUser=#{reported}
        and category=#{category}
    </select>

</mapper>